RewriteEngine on

RewriteCond %{REQUEST_URI} !^(.*)/public/
RewriteRule ^(.*)$ /404.php?q=$1 [L,QSA]